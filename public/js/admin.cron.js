webpackJsonp([1],{

/***/ 0:
/***/ function(module, exports, __webpack_require__) {

	"use strict";
	
	var React = __webpack_require__(19);
	
	var _ = __webpack_require__(17);
	
	var Collapsible = __webpack_require__(5),
	    Loader = __webpack_require__(9),
	    RenderUtils = __webpack_require__(18),
	    GuardedStateMixin = __webpack_require__(16);
	
	var CronItemHeader = __webpack_require__(25),
	    CronItemBody = __webpack_require__(26);
	
	var App = React.createClass({
	  displayName: "App",
	
	  mixins: [GuardedStateMixin],
	
	  getInitialState: function getInitialState() {
	    return {
	      loading: true,
	      tasks: [] };
	  },
	
	  render: function render() {
	    var list = this._buildList();
	
	    var loader = this.state.taskRunning ? React.createElement(Loader, null) : null;
	
	    return React.createElement(
	      "div",
	      { className: "page-cron" },
	      React.createElement(
	        "h2",
	        null,
	        "Cron tasks"
	      ),
	      loader,
	      RenderUtils.buildError(this.state.error),
	      list
	    );
	  },
	
	  componentDidMount: function componentDidMount() {
	    var self = this;
	
	    $.ajax({
	      url: "/admin/cron",
	      data: {
	        format: "json" }
	    }).done(function (data) {
	      self.setStateIfMounted({
	        tasks: _.values(data.tasks) });
	    }).fail(function (xhr) {
	      self.setStateIfMounted({
	        error: xhr
	      });
	    }).always(function () {
	      self.setStateIfMounted({
	        loading: false
	      });
	    });
	  },
	
	  _setItem: function _setItem(itemNewData) {
	    // loop through our list, and overwrite item
	    this.state.tasks.forEach(function (item) {
	      if (item._id === itemNewData._id) {
	        _.extend(item, itemNewData);
	      }
	    });
	
	    // force re-render
	    this.forceUpdate();
	  },
	
	  _buildList: function _buildList() {
	    var self = this;
	
	    if (this.state.loading) {
	      return React.createElement(Loader, null);
	    } else {
	      var tasks = this.state.tasks.map(function (item) {
	        return {
	          label: React.createElement(CronItemHeader, { item: item }),
	          body: React.createElement(CronItemBody, { item: item, reloadItem: self._setItem }) };
	      });
	
	      return React.createElement(Collapsible, { items: tasks });
	    }
	  } });
	
	React.render(React.createElement(App, null), document.getElementById("react-root"));

/***/ },

/***/ 25:
/***/ function(module, exports, __webpack_require__) {

	"use strict";
	
	var React = __webpack_require__(19);
	var Router = __webpack_require__(21);
	
	module.exports = React.createClass({
	  displayName: "exports",
	
	  propTypes: {
	    item: React.PropTypes.object },
	
	  getDefaultProps: function getDefaultProps() {
	    return {
	      item: null };
	  },
	
	  render: function render() {
	    var item = this.props.item;
	
	    var status = "status " + (item.disabled ? "inactive" : "active");
	
	    return React.createElement(
	      "span",
	      { className: "item-label" },
	      React.createElement(
	        "span",
	        { className: status },
	        item.name
	      )
	    );
	  } });

/***/ },

/***/ 26:
/***/ function(module, exports, __webpack_require__) {

	"use strict";
	
	var React = __webpack_require__(19);
	var Router = __webpack_require__(21);
	var moment = __webpack_require__(22);
	
	var Button = __webpack_require__(3),
	    Switch = __webpack_require__(14),
	    Loader = __webpack_require__(9),
	    RenderUtils = __webpack_require__(18),
	    GuardedStateMixin = __webpack_require__(16);
	
	module.exports = React.createClass({
	  displayName: "exports",
	
	  mixins: [GuardedStateMixin],
	
	  propTypes: {
	    item: React.PropTypes.object,
	    reloadItem: React.PropTypes.func },
	
	  getInitialState: function getInitialState() {
	    return {
	      loading: false,
	      error: null };
	  },
	
	  render: function render() {
	    var item = this.props.item;
	
	    if (item.lastRun) {
	      var lastRun = React.createElement(
	        "span",
	        null,
	        React.createElement(
	          "span",
	          { className: "date", title: item.lastRun.when },
	          moment(item.lastRun.when).fromNow()
	        ),
	        React.createElement(
	          "span",
	          { className: "by" },
	          item.lastRun.by.length ? item.lastRun.by : ""
	        )
	      );
	    } else {
	      var lastRun = "never";
	    }
	
	    if (!item.disabled) {
	      var nextRun = React.createElement(
	        "span",
	        { className: "date", title: item.nextRun },
	        moment(item.nextRun).fromNow()
	      );
	    } else {
	      var nextRun = React.createElement(
	        "em",
	        null,
	        "Inactive"
	      );
	    }
	
	    var loading = this.state.loading ? React.createElement(Loader, null) : null;
	
	    return React.createElement(
	      "div",
	      { className: "item-body" },
	      React.createElement(
	        "div",
	        { className: "row" },
	        React.createElement(
	          "div",
	          { className: "col m12 s12" },
	          React.createElement(
	            "div",
	            { className: "row" },
	            React.createElement(
	              "div",
	              { className: "item-label col m2 s12" },
	              "Schedule:"
	            ),
	            React.createElement(
	              "div",
	              { className: "schedule col m1 s12" },
	              item.schedule
	            ),
	            React.createElement(
	              "div",
	              { className: "item-toggle col m9 s12" },
	              React.createElement(Switch, { data: item, onChange: this._updateStatus, initiallyOn: !item.disabled })
	            )
	          ),
	          React.createElement(
	            "div",
	            { className: "row" },
	            React.createElement(
	              "div",
	              { className: "item-label col m2 s12" },
	              "Last run:"
	            ),
	            React.createElement(
	              "div",
	              { className: "lastRun col m10 s12" },
	              lastRun
	            )
	          ),
	          React.createElement(
	            "div",
	            { className: "row" },
	            React.createElement(
	              "div",
	              { className: "item-label col m2 s12" },
	              "Next run:"
	            ),
	            React.createElement(
	              "div",
	              { className: "nextRun col m10 s12" },
	              nextRun
	            )
	          )
	        )
	      ),
	      React.createElement(Button, { label: "Run now", onClick: this._run }),
	      loading,
	      RenderUtils.buildError(this.state.error)
	    );
	
	    // <a href="#" data-name={item.name} onClick={this._run}>
	    //   <i className="fa fa-play" />
	    // </a>
	  },
	
	  _updateStatus: function _updateStatus(setActive) {
	    var self = this;
	
	    self.setState({
	      error: null,
	      loading: true });
	
	    $.ajax({
	      method: "POST",
	      url: "/admin/cron/updateStatus?format=json",
	      data: {
	        name: this.props.item.name,
	        active: setActive }
	    }).done(function (data) {
	      Materialize.toast("Status updated", 2000, "rounded");
	
	      self.props.reloadItem(data.task);
	    }).fail(function (xhr) {
	      self.setStateIfMounted({
	        error: xhr
	      });
	    }).always(function () {
	      self.setStateIfMounted({
	        loading: false
	      });
	    });
	  },
	
	  _run: function _run(e) {
	    var self = this;
	
	    e.preventDefault();
	
	    self.setState({
	      loading: true,
	      error: null });
	
	    $.ajax({
	      method: "POST",
	      url: "/admin/cron/run?format=json",
	      data: {
	        name: this.props.item.name }
	    }).done(function (data) {
	      Materialize.toast("Run successful", 2000, "rounded");
	
	      self.props.reloadItem(data.task);
	    }).fail(function (xhr) {
	      self.setStateIfMounted({
	        error: xhr
	      });
	    }).always(function () {
	      self.setStateIfMounted({
	        loading: false
	      });
	    });
	  } });

/***/ }

});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9wYWdlcy9jcm9uL2FwcC5qcyIsIndlYnBhY2s6Ly8vLi9wYWdlcy9jcm9uL2Nyb25JdGVtSGVhZGVyLmpzIiwid2VicGFjazovLy8uL3BhZ2VzL2Nyb24vY3Jvbkl0ZW1Cb2R5LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsYUFBWSxDQUFDOztBQUViLEtBQUksS0FBSyxHQUFHLG1CQUFPLENBQUMsRUFBTyxDQUFDLENBQUM7O0FBRTdCLEtBQUksQ0FBQyxHQUFHLG1CQUFPLENBQUMsRUFBb0IsQ0FBQyxDQUFDOztBQUV0QyxLQUFJLFdBQVcsR0FBRyxtQkFBTyxDQUFDLENBQThCLENBQUM7S0FDckQsTUFBTSxHQUFHLG1CQUFPLENBQUMsQ0FBeUIsQ0FBQztLQUMzQyxXQUFXLEdBQUcsbUJBQU8sQ0FBQyxFQUF5QixDQUFDO0FBQ3BELEtBQUksaUJBQWlCLEdBQUcsbUJBQU8sQ0FBQyxFQUEyQixDQUFDLENBQUM7O0FBRTdELEtBQUksY0FBYyxHQUFHLG1CQUFPLENBQUMsRUFBa0IsQ0FBQztBQUNoRCxLQUFJLFlBQVksR0FBRyxtQkFBTyxDQUFDLEVBQWdCLENBQUMsQ0FBQzs7QUFFN0MsS0FBSSxHQUFHLEdBQUcsS0FBSyxDQUFDLFdBQVcsQ0FBQztBQUM1QixHQUFFLFdBQVcsRUFBRSxLQUFLOztBQUVwQixHQUFFLE1BQU0sRUFBRSxDQUFDLGlCQUFpQixDQUFDOztHQUUzQixlQUFlLEVBQUUsU0FBUyxlQUFlLEdBQUc7S0FDMUMsT0FBTztPQUNMLE9BQU8sRUFBRSxJQUFJO09BQ2IsS0FBSyxFQUFFLEVBQUUsRUFBRSxDQUFDO0FBQ2xCLElBQUc7O0dBRUQsTUFBTSxFQUFFLFNBQVMsTUFBTSxHQUFHO0FBQzVCLEtBQUksSUFBSSxJQUFJLEdBQUcsSUFBSSxDQUFDLFVBQVUsRUFBRSxDQUFDOztBQUVqQyxLQUFJLElBQUksTUFBTSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsV0FBVyxHQUFHLEtBQUss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QU0sS0FBSyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7O0tBRWpCLENBQUMsQ0FBQyxJQUFJLENBQUM7T0FDTCxNQUFNLEVBQUUsTUFBTTtPQUNkLEdBQUcsRUFBRSw2QkFBNkI7T0FDbEMsSUFBSSxFQUFFO1NBQ0osSUFBSSxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRTtNQUMvQixDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsSUFBSSxFQUFFO0FBQzVCLE9BQU0sV0FBVyxDQUFDLEtBQUssQ0FBQyxnQkFBZ0IsRUFBRSxJQUFJLEVBQUUsU0FBUyxDQUFDLENBQUM7O09BRXJELElBQUksQ0FBQyxLQUFLLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztNQUNsQyxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsR0FBRyxFQUFFO09BQ3JCLElBQUksQ0FBQyxpQkFBaUIsQ0FBQztTQUNyQixLQUFLLEVBQUUsR0FBRztRQUNYLENBQUMsQ0FBQztNQUNKLENBQUMsQ0FBQyxNQUFNLENBQUMsWUFBWTtPQUNwQixJQUFJLENBQUMsaUJBQWlCLENBQUM7U0FDckIsT0FBTyxFQUFFLEtBQUs7UUFDZixDQUFDLENBQUM7TUFDSixDQUFDLENBQUM7SUFDSixFQUFFLENBQUMsQyIsImZpbGUiOiJhZG1pbi5jcm9uLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBSZWFjdCA9IHJlcXVpcmUoXCJyZWFjdFwiKTtcblxudmFyIF8gPSByZXF1aXJlKFwiLi4vLi4vdXRpbHMvbG9kYXNoXCIpO1xuXG52YXIgQ29sbGFwc2libGUgPSByZXF1aXJlKFwiLi4vLi4vY29tcG9uZW50cy9jb2xsYXBzaWJsZVwiKSxcbiAgICBMb2FkZXIgPSByZXF1aXJlKFwiLi4vLi4vY29tcG9uZW50cy9sb2FkZXJcIiksXG4gICAgUmVuZGVyVXRpbHMgPSByZXF1aXJlKFwiLi4vLi4vdXRpbHMvcmVuZGVyVXRpbHNcIiksXG4gICAgR3VhcmRlZFN0YXRlTWl4aW4gPSByZXF1aXJlKFwiLi4vLi4vbWl4aW5zL2d1YXJkZWRTdGF0ZVwiKTtcblxudmFyIENyb25JdGVtSGVhZGVyID0gcmVxdWlyZShcIi4vY3Jvbkl0ZW1IZWFkZXJcIiksXG4gICAgQ3Jvbkl0ZW1Cb2R5ID0gcmVxdWlyZShcIi4vY3Jvbkl0ZW1Cb2R5XCIpO1xuXG52YXIgQXBwID0gUmVhY3QuY3JlYXRlQ2xhc3Moe1xuICBkaXNwbGF5TmFtZTogXCJBcHBcIixcblxuICBtaXhpbnM6IFtHdWFyZGVkU3RhdGVNaXhpbl0sXG5cbiAgZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbiBnZXRJbml0aWFsU3RhdGUoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGxvYWRpbmc6IHRydWUsXG4gICAgICB0YXNrczogW10gfTtcbiAgfSxcblxuICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcigpIHtcbiAgICB2YXIgbGlzdCA9IHRoaXMuX2J1aWxkTGlzdCgpO1xuXG4gICAgdmFyIGxvYWRlciA9IHRoaXMuc3RhdGUudGFza1J1bm5pbmcgPyBSZWFjdC5jcmVhdGVFbGVtZW50KExvYWRlciwgbnVsbCkgOiBudWxsO1xuXG4gICAgcmV0dXJuIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICBcImRpdlwiLFxuICAgICAgeyBjbGFzc05hbWU6IFwicGFnZS1jcm9uXCIgfSxcbiAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgIFwiaDJcIixcbiAgICAgICAgbnVsbCxcbiAgICAgICAgXCJDcm9uIHRhc2tzXCJcbiAgICAgICksXG4gICAgICBsb2FkZXIsXG4gICAgICBSZW5kZXJVdGlscy5idWlsZEVycm9yKHRoaXMuc3RhdGUuZXJyb3IpLFxuICAgICAgbGlzdFxuICAgICk7XG4gIH0sXG5cbiAgY29tcG9uZW50RGlkTW91bnQ6IGZ1bmN0aW9uIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgICQuYWpheCh7XG4gICAgICB1cmw6IFwiL2FkbWluL2Nyb25cIixcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgZm9ybWF0OiBcImpzb25cIiB9XG4gICAgfSkuZG9uZShmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgc2VsZi5zZXRTdGF0ZUlmTW91bnRlZCh7XG4gICAgICAgIHRhc2tzOiBfLnZhbHVlcyhkYXRhLnRhc2tzKSB9KTtcbiAgICB9KS5mYWlsKGZ1bmN0aW9uICh4aHIpIHtcbiAgICAgIHNlbGYuc2V0U3RhdGVJZk1vdW50ZWQoe1xuICAgICAgICBlcnJvcjogeGhyXG4gICAgICB9KTtcbiAgICB9KS5hbHdheXMoZnVuY3Rpb24gKCkge1xuICAgICAgc2VsZi5zZXRTdGF0ZUlmTW91bnRlZCh7XG4gICAgICAgIGxvYWRpbmc6IGZhbHNlXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSxcblxuICBfc2V0SXRlbTogZnVuY3Rpb24gX3NldEl0ZW0oaXRlbU5ld0RhdGEpIHtcbiAgICAvLyBsb29wIHRocm91Z2ggb3VyIGxpc3QsIGFuZCBvdmVyd3JpdGUgaXRlbVxuICAgIHRoaXMuc3RhdGUudGFza3MuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgaWYgKGl0ZW0uX2lkID09PSBpdGVtTmV3RGF0YS5faWQpIHtcbiAgICAgICAgXy5leHRlbmQoaXRlbSwgaXRlbU5ld0RhdGEpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gZm9yY2UgcmUtcmVuZGVyXG4gICAgdGhpcy5mb3JjZVVwZGF0ZSgpO1xuICB9LFxuXG4gIF9idWlsZExpc3Q6IGZ1bmN0aW9uIF9idWlsZExpc3QoKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgaWYgKHRoaXMuc3RhdGUubG9hZGluZykge1xuICAgICAgcmV0dXJuIFJlYWN0LmNyZWF0ZUVsZW1lbnQoTG9hZGVyLCBudWxsKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIHRhc2tzID0gdGhpcy5zdGF0ZS50YXNrcy5tYXAoZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBsYWJlbDogUmVhY3QuY3JlYXRlRWxlbWVudChDcm9uSXRlbUhlYWRlciwgeyBpdGVtOiBpdGVtIH0pLFxuICAgICAgICAgIGJvZHk6IFJlYWN0LmNyZWF0ZUVsZW1lbnQoQ3Jvbkl0ZW1Cb2R5LCB7IGl0ZW06IGl0ZW0sIHJlbG9hZEl0ZW06IHNlbGYuX3NldEl0ZW0gfSkgfTtcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gUmVhY3QuY3JlYXRlRWxlbWVudChDb2xsYXBzaWJsZSwgeyBpdGVtczogdGFza3MgfSk7XG4gICAgfVxuICB9IH0pO1xuXG5SZWFjdC5yZW5kZXIoUmVhY3QuY3JlYXRlRWxlbWVudChBcHAsIG51bGwpLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInJlYWN0LXJvb3RcIikpO1xuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC9Vc2Vycy9yYW0vZGV2L2pzL3dhaWdvLWZyYW1ld29yay93YWlnby9+L2JhYmVsLWxvYWRlcj9leHBlcmltZW50YWwmb3B0aW9uYWw9cnVudGltZSEuL3BhZ2VzL2Nyb24vYXBwLmpzXG4gKiovIiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBSZWFjdCA9IHJlcXVpcmUoXCJyZWFjdFwiKTtcbnZhciBSb3V0ZXIgPSByZXF1aXJlKFwicmVhY3Qtcm91dGVyXCIpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcbiAgZGlzcGxheU5hbWU6IFwiZXhwb3J0c1wiLFxuXG4gIHByb3BUeXBlczoge1xuICAgIGl0ZW06IFJlYWN0LlByb3BUeXBlcy5vYmplY3QgfSxcblxuICBnZXREZWZhdWx0UHJvcHM6IGZ1bmN0aW9uIGdldERlZmF1bHRQcm9wcygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgaXRlbTogbnVsbCB9O1xuICB9LFxuXG4gIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKCkge1xuICAgIHZhciBpdGVtID0gdGhpcy5wcm9wcy5pdGVtO1xuXG4gICAgdmFyIHN0YXR1cyA9IFwic3RhdHVzIFwiICsgKGl0ZW0uZGlzYWJsZWQgPyBcImluYWN0aXZlXCIgOiBcImFjdGl2ZVwiKTtcblxuICAgIHJldHVybiBSZWFjdC5jcmVhdGVFbGVtZW50KFxuICAgICAgXCJzcGFuXCIsXG4gICAgICB7IGNsYXNzTmFtZTogXCJpdGVtLWxhYmVsXCIgfSxcbiAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgIFwic3BhblwiLFxuICAgICAgICB7IGNsYXNzTmFtZTogc3RhdHVzIH0sXG4gICAgICAgIGl0ZW0ubmFtZVxuICAgICAgKVxuICAgICk7XG4gIH0gfSk7XG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogL1VzZXJzL3JhbS9kZXYvanMvd2FpZ28tZnJhbWV3b3JrL3dhaWdvL34vYmFiZWwtbG9hZGVyP2V4cGVyaW1lbnRhbCZvcHRpb25hbD1ydW50aW1lIS4vcGFnZXMvY3Jvbi9jcm9uSXRlbUhlYWRlci5qc1xuICoqLyIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgUmVhY3QgPSByZXF1aXJlKFwicmVhY3RcIik7XG52YXIgUm91dGVyID0gcmVxdWlyZShcInJlYWN0LXJvdXRlclwiKTtcbnZhciBtb21lbnQgPSByZXF1aXJlKFwibW9tZW50XCIpO1xuXG52YXIgQnV0dG9uID0gcmVxdWlyZShcIi4uLy4uL2NvbXBvbmVudHMvYnV0dG9uXCIpLFxuICAgIFN3aXRjaCA9IHJlcXVpcmUoXCIuLi8uLi9jb21wb25lbnRzL3N3aXRjaFwiKSxcbiAgICBMb2FkZXIgPSByZXF1aXJlKFwiLi4vLi4vY29tcG9uZW50cy9sb2FkZXJcIiksXG4gICAgUmVuZGVyVXRpbHMgPSByZXF1aXJlKFwiLi4vLi4vdXRpbHMvcmVuZGVyVXRpbHNcIiksXG4gICAgR3VhcmRlZFN0YXRlTWl4aW4gPSByZXF1aXJlKFwiLi4vLi4vbWl4aW5zL2d1YXJkZWRTdGF0ZVwiKTtcblxubW9kdWxlLmV4cG9ydHMgPSBSZWFjdC5jcmVhdGVDbGFzcyh7XG4gIGRpc3BsYXlOYW1lOiBcImV4cG9ydHNcIixcblxuICBtaXhpbnM6IFtHdWFyZGVkU3RhdGVNaXhpbl0sXG5cbiAgcHJvcFR5cGVzOiB7XG4gICAgaXRlbTogUmVhY3QuUHJvcFR5cGVzLm9iamVjdCxcbiAgICByZWxvYWRJdGVtOiBSZWFjdC5Qcm9wVHlwZXMuZnVuYyB9LFxuXG4gIGdldEluaXRpYWxTdGF0ZTogZnVuY3Rpb24gZ2V0SW5pdGlhbFN0YXRlKCkge1xuICAgIHJldHVybiB7XG4gICAgICBsb2FkaW5nOiBmYWxzZSxcbiAgICAgIGVycm9yOiBudWxsIH07XG4gIH0sXG5cbiAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIoKSB7XG4gICAgdmFyIGl0ZW0gPSB0aGlzLnByb3BzLml0ZW07XG5cbiAgICBpZiAoaXRlbS5sYXN0UnVuKSB7XG4gICAgICB2YXIgbGFzdFJ1biA9IFJlYWN0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgIFwic3BhblwiLFxuICAgICAgICBudWxsLFxuICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgIFwic3BhblwiLFxuICAgICAgICAgIHsgY2xhc3NOYW1lOiBcImRhdGVcIiwgdGl0bGU6IGl0ZW0ubGFzdFJ1bi53aGVuIH0sXG4gICAgICAgICAgbW9tZW50KGl0ZW0ubGFzdFJ1bi53aGVuKS5mcm9tTm93KClcbiAgICAgICAgKSxcbiAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICBcInNwYW5cIixcbiAgICAgICAgICB7IGNsYXNzTmFtZTogXCJieVwiIH0sXG4gICAgICAgICAgaXRlbS5sYXN0UnVuLmJ5Lmxlbmd0aCA/IGl0ZW0ubGFzdFJ1bi5ieSA6IFwiXCJcbiAgICAgICAgKVxuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIGxhc3RSdW4gPSBcIm5ldmVyXCI7XG4gICAgfVxuXG4gICAgaWYgKCFpdGVtLmRpc2FibGVkKSB7XG4gICAgICB2YXIgbmV4dFJ1biA9IFJlYWN0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgIFwic3BhblwiLFxuICAgICAgICB7IGNsYXNzTmFtZTogXCJkYXRlXCIsIHRpdGxlOiBpdGVtLm5leHRSdW4gfSxcbiAgICAgICAgbW9tZW50KGl0ZW0ubmV4dFJ1bikuZnJvbU5vdygpXG4gICAgICApO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgbmV4dFJ1biA9IFJlYWN0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgIFwiZW1cIixcbiAgICAgICAgbnVsbCxcbiAgICAgICAgXCJJbmFjdGl2ZVwiXG4gICAgICApO1xuICAgIH1cblxuICAgIHZhciBsb2FkaW5nID0gdGhpcy5zdGF0ZS5sb2FkaW5nID8gUmVhY3QuY3JlYXRlRWxlbWVudChMb2FkZXIsIG51bGwpIDogbnVsbDtcblxuICAgIHJldHVybiBSZWFjdC5jcmVhdGVFbGVtZW50KFxuICAgICAgXCJkaXZcIixcbiAgICAgIHsgY2xhc3NOYW1lOiBcIml0ZW0tYm9keVwiIH0sXG4gICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICBcImRpdlwiLFxuICAgICAgICB7IGNsYXNzTmFtZTogXCJyb3dcIiB9LFxuICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgIFwiZGl2XCIsXG4gICAgICAgICAgeyBjbGFzc05hbWU6IFwiY29sIG0xMiBzMTJcIiB9LFxuICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgICBcImRpdlwiLFxuICAgICAgICAgICAgeyBjbGFzc05hbWU6IFwicm93XCIgfSxcbiAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgICAgIFwiZGl2XCIsXG4gICAgICAgICAgICAgIHsgY2xhc3NOYW1lOiBcIml0ZW0tbGFiZWwgY29sIG0yIHMxMlwiIH0sXG4gICAgICAgICAgICAgIFwiU2NoZWR1bGU6XCJcbiAgICAgICAgICAgICksXG4gICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgICBcImRpdlwiLFxuICAgICAgICAgICAgICB7IGNsYXNzTmFtZTogXCJzY2hlZHVsZSBjb2wgbTEgczEyXCIgfSxcbiAgICAgICAgICAgICAgaXRlbS5zY2hlZHVsZVxuICAgICAgICAgICAgKSxcbiAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgICAgIFwiZGl2XCIsXG4gICAgICAgICAgICAgIHsgY2xhc3NOYW1lOiBcIml0ZW0tdG9nZ2xlIGNvbCBtOSBzMTJcIiB9LFxuICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KFN3aXRjaCwgeyBkYXRhOiBpdGVtLCBvbkNoYW5nZTogdGhpcy5fdXBkYXRlU3RhdHVzLCBpbml0aWFsbHlPbjogIWl0ZW0uZGlzYWJsZWQgfSlcbiAgICAgICAgICAgIClcbiAgICAgICAgICApLFxuICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgICBcImRpdlwiLFxuICAgICAgICAgICAgeyBjbGFzc05hbWU6IFwicm93XCIgfSxcbiAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgICAgIFwiZGl2XCIsXG4gICAgICAgICAgICAgIHsgY2xhc3NOYW1lOiBcIml0ZW0tbGFiZWwgY29sIG0yIHMxMlwiIH0sXG4gICAgICAgICAgICAgIFwiTGFzdCBydW46XCJcbiAgICAgICAgICAgICksXG4gICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgICBcImRpdlwiLFxuICAgICAgICAgICAgICB7IGNsYXNzTmFtZTogXCJsYXN0UnVuIGNvbCBtMTAgczEyXCIgfSxcbiAgICAgICAgICAgICAgbGFzdFJ1blxuICAgICAgICAgICAgKVxuICAgICAgICAgICksXG4gICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgIFwiZGl2XCIsXG4gICAgICAgICAgICB7IGNsYXNzTmFtZTogXCJyb3dcIiB9LFxuICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICAgXCJkaXZcIixcbiAgICAgICAgICAgICAgeyBjbGFzc05hbWU6IFwiaXRlbS1sYWJlbCBjb2wgbTIgczEyXCIgfSxcbiAgICAgICAgICAgICAgXCJOZXh0IHJ1bjpcIlxuICAgICAgICAgICAgKSxcbiAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgICAgIFwiZGl2XCIsXG4gICAgICAgICAgICAgIHsgY2xhc3NOYW1lOiBcIm5leHRSdW4gY29sIG0xMCBzMTJcIiB9LFxuICAgICAgICAgICAgICBuZXh0UnVuXG4gICAgICAgICAgICApXG4gICAgICAgICAgKVxuICAgICAgICApXG4gICAgICApLFxuICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChCdXR0b24sIHsgbGFiZWw6IFwiUnVuIG5vd1wiLCBvbkNsaWNrOiB0aGlzLl9ydW4gfSksXG4gICAgICBsb2FkaW5nLFxuICAgICAgUmVuZGVyVXRpbHMuYnVpbGRFcnJvcih0aGlzLnN0YXRlLmVycm9yKVxuICAgICk7XG5cbiAgICAvLyA8YSBocmVmPVwiI1wiIGRhdGEtbmFtZT17aXRlbS5uYW1lfSBvbkNsaWNrPXt0aGlzLl9ydW59PlxuICAgIC8vICAgPGkgY2xhc3NOYW1lPVwiZmEgZmEtcGxheVwiIC8+XG4gICAgLy8gPC9hPlxuICB9LFxuXG4gIF91cGRhdGVTdGF0dXM6IGZ1bmN0aW9uIF91cGRhdGVTdGF0dXMoc2V0QWN0aXZlKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgc2VsZi5zZXRTdGF0ZSh7XG4gICAgICBlcnJvcjogbnVsbCxcbiAgICAgIGxvYWRpbmc6IHRydWUgfSk7XG5cbiAgICAkLmFqYXgoe1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIHVybDogXCIvYWRtaW4vY3Jvbi91cGRhdGVTdGF0dXM/Zm9ybWF0PWpzb25cIixcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgbmFtZTogdGhpcy5wcm9wcy5pdGVtLm5hbWUsXG4gICAgICAgIGFjdGl2ZTogc2V0QWN0aXZlIH1cbiAgICB9KS5kb25lKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICBNYXRlcmlhbGl6ZS50b2FzdChcIlN0YXR1cyB1cGRhdGVkXCIsIDIwMDAsIFwicm91bmRlZFwiKTtcblxuICAgICAgc2VsZi5wcm9wcy5yZWxvYWRJdGVtKGRhdGEudGFzayk7XG4gICAgfSkuZmFpbChmdW5jdGlvbiAoeGhyKSB7XG4gICAgICBzZWxmLnNldFN0YXRlSWZNb3VudGVkKHtcbiAgICAgICAgZXJyb3I6IHhoclxuICAgICAgfSk7XG4gICAgfSkuYWx3YXlzKGZ1bmN0aW9uICgpIHtcbiAgICAgIHNlbGYuc2V0U3RhdGVJZk1vdW50ZWQoe1xuICAgICAgICBsb2FkaW5nOiBmYWxzZVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH0sXG5cbiAgX3J1bjogZnVuY3Rpb24gX3J1bihlKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgc2VsZi5zZXRTdGF0ZSh7XG4gICAgICBsb2FkaW5nOiB0cnVlLFxuICAgICAgZXJyb3I6IG51bGwgfSk7XG5cbiAgICAkLmFqYXgoe1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIHVybDogXCIvYWRtaW4vY3Jvbi9ydW4/Zm9ybWF0PWpzb25cIixcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgbmFtZTogdGhpcy5wcm9wcy5pdGVtLm5hbWUgfVxuICAgIH0pLmRvbmUoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgIE1hdGVyaWFsaXplLnRvYXN0KFwiUnVuIHN1Y2Nlc3NmdWxcIiwgMjAwMCwgXCJyb3VuZGVkXCIpO1xuXG4gICAgICBzZWxmLnByb3BzLnJlbG9hZEl0ZW0oZGF0YS50YXNrKTtcbiAgICB9KS5mYWlsKGZ1bmN0aW9uICh4aHIpIHtcbiAgICAgIHNlbGYuc2V0U3RhdGVJZk1vdW50ZWQoe1xuICAgICAgICBlcnJvcjogeGhyXG4gICAgICB9KTtcbiAgICB9KS5hbHdheXMoZnVuY3Rpb24gKCkge1xuICAgICAgc2VsZi5zZXRTdGF0ZUlmTW91bnRlZCh7XG4gICAgICAgIGxvYWRpbmc6IGZhbHNlXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSB9KTtcblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAvVXNlcnMvcmFtL2Rldi9qcy93YWlnby1mcmFtZXdvcmsvd2FpZ28vfi9iYWJlbC1sb2FkZXI/ZXhwZXJpbWVudGFsJm9wdGlvbmFsPXJ1bnRpbWUhLi9wYWdlcy9jcm9uL2Nyb25JdGVtQm9keS5qc1xuICoqLyJdLCJzb3VyY2VSb290IjoiIn0=