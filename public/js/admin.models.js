webpackJsonp([2],{

/***/ 0:
/***/ function(module, exports, __webpack_require__) {

	"use strict";
	
	var React = __webpack_require__(17);
	var Router = __webpack_require__(18);
	var DefaultRoute = Router.DefaultRoute;
	var RouteHandler = Router.RouteHandler;
	var Route = Router.Route;
	
	var Models = __webpack_require__(25);
	var Model = __webpack_require__(26);
	var Row = __webpack_require__(27);
	
	var App = React.createClass({
	  displayName: "App",
	
	  render: function render() {
	    return React.createElement(RouteHandler, this.props);
	  }
	});
	
	var routes = React.createElement(
	  Route,
	  { handler: App },
	  React.createElement(DefaultRoute, { name: "models", handler: Models }),
	  React.createElement(Route, { name: "model", path: "/:key", handler: Model }),
	  React.createElement(Route, { name: "modelRow", path: "/:key/:id", handler: Row })
	);
	
	Router.run(routes, Router.HashLocation, function (Handler, state) {
	  React.render(React.createElement(Handler, { routes: state.routes, params: state.params, query: state.query }), document.getElementById("react-root"));
	});

/***/ },

/***/ 25:
/***/ function(module, exports, __webpack_require__) {

	"use strict";
	
	var React = __webpack_require__(17);
	
	var Router = __webpack_require__(18),
	    Link = Router.Link;
	
	var FilterList = __webpack_require__(5),
	    RenderUtils = __webpack_require__(15);
	
	module.exports = React.createClass({
	  displayName: "exports",
	
	  render: function render() {
	    return React.createElement(
	      "div",
	      { className: "page-models" },
	      React.createElement(FilterList, {
	        ajaxUrl: "/admin/models?format=json",
	        ajaxResponseDataMapper: this._mapAjaxData,
	        itemDisplayNameFormatter: this._getItemDisplayName,
	        itemRoute: "model" })
	    );
	  },
	
	  _mapAjaxData: function _mapAjaxData(data) {
	    data = data || {};
	
	    return (data.models || []).map(function (r) {
	      return {
	        key: r,
	        name: r };
	    });
	  },
	
	  _getItemDisplayName: function _getItemDisplayName(item) {
	    return React.createElement(
	      "span",
	      null,
	      item.name
	    );
	  } });

/***/ },

/***/ 26:
/***/ function(module, exports, __webpack_require__) {

	"use strict";
	
	var React = __webpack_require__(17);
	var Router = __webpack_require__(18);
	var Link = Router.Link;
	
	var Timer = __webpack_require__(16).Timer;
	
	var _ = __webpack_require__(14),
	    Loader = __webpack_require__(7),
	    RenderUtils = __webpack_require__(15),
	    ModelTable = __webpack_require__(9),
	    Button = __webpack_require__(2),
	    GuardedStateMixin = __webpack_require__(13);
	
	module.exports = React.createClass({
	  displayName: "exports",
	
	  contextTypes: {
	    router: React.PropTypes.func
	  },
	
	  mixins: [GuardedStateMixin],
	
	  getInitialState: function getInitialState() {
	    return {
	      modelName: decodeURIComponent(this.context.router.getCurrentParams().key),
	      columns: null };
	  },
	
	  _onRowClick: function _onRowClick(item) {
	    this.context.router.transitionTo("modelRow", {
	      key: this.context.router.getCurrentParams().key,
	      id: item._id
	    });
	  },
	
	  _onAddClick: function _onAddClick() {
	    this.context.router.transitionTo("modelRow", {
	      key: this.context.router.getCurrentParams().key,
	      id: "new"
	    });
	  },
	
	  render: function render() {
	    var result = null;
	
	    if (!this.state.columns) {
	      result = React.createElement(
	        "div",
	        null,
	        React.createElement(Loader, { text: "Loading structure" }),
	        RenderUtils.buildError(this.state.error)
	      );
	    } else {
	      result = React.createElement(ModelTable, {
	        modelName: this.state.modelName,
	        columns: this.state.columns,
	        onRowClick: this._onRowClick });
	    }
	
	    return React.createElement(
	      "div",
	      { className: "page-model" },
	      React.createElement(Button, { icon: "plus-circle", label: "Add", className: "add-button", onClick: this._onAddClick }),
	      React.createElement(
	        "h2",
	        null,
	        React.createElement(
	          Link,
	          { to: "models" },
	          "Collection"
	        ),
	        React.createElement(
	          "span",
	          null,
	          " / ",
	          this.state.modelName
	        )
	      ),
	      result
	    );
	  },
	
	  componentDidMount: function componentDidMount() {
	    var self = this;
	
	    // fetch column info
	    $.ajax({
	      url: "/admin/models/model/columns",
	      data: {
	        format: "json",
	        name: this.state.modelName }
	    }).done(function (data) {
	      self.setStateIfMounted({
	        columns: data.columns
	      });
	    }).fail(function (xhr) {
	      self.setStateIfMounted({
	        error: xhr
	      });
	    });
	    ;
	  } });

/***/ },

/***/ 27:
/***/ function(module, exports, __webpack_require__) {

	"use strict";
	
	var _core = __webpack_require__(56)["default"];
	
	var React = __webpack_require__(17);
	var Router = __webpack_require__(18);
	var Link = Router.Link;
	
	var Loader = __webpack_require__(7),
	    Button = __webpack_require__(2),
	    JsonEditor = __webpack_require__(6),
	    Modal = __webpack_require__(8),
	    RenderUtils = __webpack_require__(15),
	    GuardedStateMixin = __webpack_require__(13);
	
	module.exports = React.createClass({
	  displayName: "exports",
	
	  contextTypes: {
	    router: React.PropTypes.func
	  },
	
	  mixins: [GuardedStateMixin],
	
	  getInitialState: function getInitialState() {
	    var params = this.context.router.getCurrentParams();
	
	    return {
	      modelName: decodeURIComponent(params.key),
	      id: decodeURIComponent(params.id),
	      error: null };
	  },
	
	  render: function render() {
	    var editingForm = this._buildEditingForm();
	
	    return React.createElement(
	      "div",
	      { className: "page-modelRow" },
	      React.createElement(
	        "h2",
	        { className: "title" },
	        React.createElement(
	          Link,
	          { to: "model", params: { key: this.state.modelName } },
	          this.state.modelName
	        ),
	        React.createElement(
	          "span",
	          null,
	          " / ",
	          this.state.id
	        )
	      ),
	      RenderUtils.buildError(this.state.error),
	      editingForm
	    );
	  },
	
	  componentDidMount: function componentDidMount() {
	    this._load();
	  },
	
	  _buildEditingForm: function _buildEditingForm() {
	    if (undefined === this.state.jsonStr) {
	      return React.createElement(Loader, { text: "Loading data" });
	    }
	
	    var json = this.state.jsonStr ? JSON.parse(this.state.jsonStr) : null;
	
	    var deleteButton = null,
	        saveBtnLabel = "Create";
	
	    if ("new" !== this.state.id) {
	      saveBtnLabel = "Update";
	
	      deleteButton = React.createElement(Button, { label: "Delete", color: "red", onClick: this._showDeleteModal });
	    }
	
	    return React.createElement(
	      "div",
	      null,
	      React.createElement(JsonEditor, {
	        onChange: this._onDataChange,
	        value: json,
	        height: "400px",
	        ref: "editor" }),
	      React.createElement(
	        "div",
	        { className: "actions" },
	        React.createElement(Button, { label: saveBtnLabel, disabled: !json, onClick: this._save }),
	        deleteButton
	      ),
	      React.createElement(
	        Modal,
	        {
	          ref: "deleteModal",
	          id: "deleteDocModal",
	          actions: ["Yes", "No"],
	          onAction: this._onDeleteModalAction },
	        React.createElement(
	          "span",
	          null,
	          "Are you sure you want to remove this document from the collection?"
	        )
	      )
	    );
	  },
	
	  _onDataChange: function _onDataChange(jsonStr) {
	    try {
	      var json = JSON.parse(jsonStr);
	
	      // must not be empty object
	      if (!json || !_core.Object.keys(json).length) {
	        throw new Error();
	      }
	
	      this.setState({
	        jsonStr: jsonStr
	      });
	    } catch (err) {
	      this.setState({
	        jsonStr: null
	      });
	    }
	  },
	
	  _load: function _load() {
	    var self = this;
	
	    // if creating a new item then no need to fetch data to start with
	    if ("new" === this.state.id) {
	      return this.setState({
	        jsonStr: {}
	      });
	    }
	
	    $.ajax({
	      url: "/admin/models/model/doc",
	      data: {
	        format: "json",
	        name: this.state.modelName,
	        id: this.state.id }
	    }).done(function (data) {
	      var doc = JSON.parse(data.doc);
	
	      // remove id attribute
	      delete doc._id;
	
	      self.setStateIfMounted({
	        jsonStr: JSON.stringify(doc)
	      });
	    }).fail(function (xhr) {
	      self.setStateIfMounted({
	        error: xhr
	      });
	    });
	    ;
	  },
	
	  _update: function _update() {
	    var self = this;
	
	    this.setState({
	      submitting: true,
	      error: null
	    });
	
	    $.ajax({
	      method: "PUT",
	      url: "/admin/models/model/doc?format=json&name=" + this.state.modelName + "&id=" + this.state.id,
	      data: {
	        doc: this.state.jsonStr
	      }
	    }).then(function () {
	      Materialize.toast("Update successful", 2000, "rounded");
	    }).fail(function (xhr) {
	      self.setStateIfMounted({
	        error: xhr
	      });
	    }).always(function () {
	      self.setStateIfMounted({
	        submitting: false
	      });
	    });
	  },
	
	  _create: function _create() {
	    var self = this;
	
	    this.setState({
	      submitting: true,
	      error: null
	    });
	
	    $.ajax({
	      method: "POST",
	      url: "/admin/models/model/doc?format=json&name=" + this.state.modelName,
	      data: {
	        doc: this.state.jsonStr
	      }
	    }).then(function (data) {
	      Materialize.toast("Create successful", 2000, "rounded");
	
	      var doc = JSON.parse(data.doc),
	          id = doc._id;
	
	      delete doc._id;
	
	      self.setStateIfMounted({
	        id: id,
	        jsonStr: JSON.stringify(doc) });
	    }).fail(function (xhr) {
	      self.setStateIfMounted({
	        error: xhr
	      });
	    }).always(function () {
	      self.setStateIfMounted({
	        submitting: false
	      });
	    });
	  },
	
	  _save: function _save() {
	    if ("new" === this.state.id) {
	      this._create();
	    } else {
	      this._update();
	    }
	  },
	
	  _delete: function _delete() {
	    var self = this;
	
	    this.setState({
	      submitting: true,
	      error: null });
	
	    $.ajax({
	      method: "DELETE",
	      url: "/admin/models/model/doc?format=json&name=" + this.state.modelName + "&id=" + this.state.id }).then(function () {
	      Materialize.toast("Delete successful", 2000, "rounded");
	
	      self.context.router.transitionTo("model", {
	        key: self.context.router.getCurrentParams().key });
	    }).fail(function (xhr) {
	      self.setStateIfMounted({
	        error: xhr
	      });
	    }).always(function () {
	      self.setStateIfMounted({
	        submitting: false
	      });
	    });
	  },
	
	  _showDeleteModal: function _showDeleteModal() {
	    this.refs.deleteModal.open();
	  },
	
	  _onDeleteModalAction: function _onDeleteModalAction(action) {
	    if ("yes" === action.toLowerCase()) {
	      this._delete();
	    }
	  } });

/***/ }

});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9wYWdlcy9tb2RlbHMvYXBwLmpzIiwid2VicGFjazovLy8uL3BhZ2VzL21vZGVscy9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9wYWdlcy9tb2RlbHMvbW9kZWwuanMiLCJ3ZWJwYWNrOi8vLy4vcGFnZXMvbW9kZWxzL3Jvdy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLGFBQVksQ0FBQzs7QUFFYixLQUFJLEtBQUssR0FBRyxtQkFBTyxDQUFDLEVBQU8sQ0FBQyxDQUFDO0FBQzdCLEtBQUksTUFBTSxHQUFHLG1CQUFPLENBQUMsRUFBYyxDQUFDLENBQUM7QUFDckMsS0FBSSxZQUFZLEdBQUcsTUFBTSxDQUFDLFlBQVksQ0FBQztBQUN2QyxLQUFJLFlBQVksR0FBRyxNQUFNLENBQUMsWUFBWSxDQUFDO0FBQ3ZDLEtBQUksS0FBSyxHQUFHLE1BQU0sQ0FBQyxLQUFLLENBQUM7O0FBRXpCLEtBQUksTUFBTSxHQUFHLG1CQUFPLENBQUMsRUFBUyxDQUFDLENBQUM7QUFDaEMsS0FBSSxLQUFLLEdBQUcsbUJBQU8sQ0FBQyxFQUFTLENBQUMsQ0FBQztBQUMvQixLQUFJLEdBQUcsR0FBRyxtQkFBTyxDQUFDLEVBQU8sQ0FBQyxDQUFDOztBQUUzQixLQUFJLEdBQUcsR0FBRyxLQUFLLENBQUMsV0FBVyxDQUFDO0FBQzVCLEdBQUUsV0FBVyxFQUFFLEtBQUs7O0dBRWxCLE1BQU0sRUFBRSxTQUFTLE1BQU0sR0FBRztLQUN4QixPQUFPLEtBQUssQ0FBQyxhQUFhLENBQUMsWUFBWSxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUN0RDtBQUNILEVBQUMsQ0FBQyxDQUFDOztBQUVILEtBQUksTUFBTSxHQUFHLEtBQUssQ0FBQyxhQUFhO0dBQzlCLEtBQUs7R0FDTCxFQUFFLE9BQU8sRUFBRSxHQUFHLEVBQUU7R0FDaEIsS0FBSyxDQUFDLGFBQWEsQ0FBQyxZQUFZLEVBQUUsRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFF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ZmlsZSI6ImFkbWluLm1vZGVscy5qcyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG52YXIgUmVhY3QgPSByZXF1aXJlKFwicmVhY3RcIik7XG52YXIgUm91dGVyID0gcmVxdWlyZShcInJlYWN0LXJvdXRlclwiKTtcbnZhciBEZWZhdWx0Um91dGUgPSBSb3V0ZXIuRGVmYXVsdFJvdXRlO1xudmFyIFJvdXRlSGFuZGxlciA9IFJvdXRlci5Sb3V0ZUhhbmRsZXI7XG52YXIgUm91dGUgPSBSb3V0ZXIuUm91dGU7XG5cbnZhciBNb2RlbHMgPSByZXF1aXJlKFwiLi9pbmRleFwiKTtcbnZhciBNb2RlbCA9IHJlcXVpcmUoXCIuL21vZGVsXCIpO1xudmFyIFJvdyA9IHJlcXVpcmUoXCIuL3Jvd1wiKTtcblxudmFyIEFwcCA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcbiAgZGlzcGxheU5hbWU6IFwiQXBwXCIsXG5cbiAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIoKSB7XG4gICAgcmV0dXJuIFJlYWN0LmNyZWF0ZUVsZW1lbnQoUm91dGVIYW5kbGVyLCB0aGlzLnByb3BzKTtcbiAgfVxufSk7XG5cbnZhciByb3V0ZXMgPSBSZWFjdC5jcmVhdGVFbGVtZW50KFxuICBSb3V0ZSxcbiAgeyBoYW5kbGVyOiBBcHAgfSxcbiAgUmVhY3QuY3JlYXRlRWxlbWVudChEZWZhdWx0Um91dGUsIHsgbmFtZTogXCJtb2RlbHNcIiwgaGFuZGxlcjogTW9kZWxzIH0pLFxuICBSZWFjdC5jcmVhdGVFbGVtZW50KFJvdXRlLCB7IG5hbWU6IFwibW9kZWxcIiwgcGF0aDogXCIvOmtleVwiLCBoYW5kbGVyOiBNb2RlbCB9KSxcbiAgUmVhY3QuY3JlYXRlRWxlbWVudChSb3V0ZSwgeyBuYW1lOiBcIm1vZGVsUm93XCIsIHBhdGg6IFwiLzprZXkvOmlkXCIsIGhhbmRsZXI6IFJvdyB9KVxuKTtcblxuUm91dGVyLnJ1bihyb3V0ZXMsIFJvdXRlci5IYXNoTG9jYXRpb24sIGZ1bmN0aW9uIChIYW5kbGVyLCBzdGF0ZSkge1xuICBSZWFjdC5yZW5kZXIoUmVhY3QuY3JlYXRlRWxlbWVudChIYW5kbGVyLCB7IHJvdXRlczogc3RhdGUucm91dGVzLCBwYXJhbXM6IHN0YXRlLnBhcmFtcywgcXVlcnk6IHN0YXRlLnF1ZXJ5IH0pLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInJlYWN0LXJvb3RcIikpO1xufSk7XG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogL1VzZXJzL3JhbS9kZXYvanMvd2FpZ28tZnJhbWV3b3JrL3dhaWdvL34vYmFiZWwtbG9hZGVyP2V4cGVyaW1lbnRhbCZvcHRpb25hbD1ydW50aW1lIS4vcGFnZXMvbW9kZWxzL2FwcC5qc1xuICoqLyIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgUmVhY3QgPSByZXF1aXJlKFwicmVhY3RcIik7XG5cbnZhciBSb3V0ZXIgPSByZXF1aXJlKFwicmVhY3Qtcm91dGVyXCIpLFxuICAgIExpbmsgPSBSb3V0ZXIuTGluaztcblxudmFyIEZpbHRlckxpc3QgPSByZXF1aXJlKFwiLi4vLi4vY29tcG9uZW50cy9maWx0ZXJMaXN0XCIpLFxuICAgIFJlbmRlclV0aWxzID0gcmVxdWlyZShcIi4uLy4uL3V0aWxzL3JlbmRlclV0aWxzXCIpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcbiAgZGlzcGxheU5hbWU6IFwiZXhwb3J0c1wiLFxuXG4gIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKCkge1xuICAgIHJldHVybiBSZWFjdC5jcmVhdGVFbGVtZW50KFxuICAgICAgXCJkaXZcIixcbiAgICAgIHsgY2xhc3NOYW1lOiBcInBhZ2UtbW9kZWxzXCIgfSxcbiAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoRmlsdGVyTGlzdCwge1xuICAgICAgICBhamF4VXJsOiBcIi9hZG1pbi9tb2RlbHM/Zm9ybWF0PWpzb25cIixcbiAgICAgICAgYWpheFJlc3BvbnNlRGF0YU1hcHBlcjogdGhpcy5fbWFwQWpheERhdGEsXG4gICAgICAgIGl0ZW1EaXNwbGF5TmFtZUZvcm1hdHRlcjogdGhpcy5fZ2V0SXRlbURpc3BsYXlOYW1lLFxuICAgICAgICBpdGVtUm91dGU6IFwibW9kZWxcIiB9KVxuICAgICk7XG4gIH0sXG5cbiAgX21hcEFqYXhEYXRhOiBmdW5jdGlvbiBfbWFwQWpheERhdGEoZGF0YSkge1xuICAgIGRhdGEgPSBkYXRhIHx8IHt9O1xuXG4gICAgcmV0dXJuIChkYXRhLm1vZGVscyB8fCBbXSkubWFwKGZ1bmN0aW9uIChyKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBrZXk6IHIsXG4gICAgICAgIG5hbWU6IHIgfTtcbiAgICB9KTtcbiAgfSxcblxuICBfZ2V0SXRlbURpc3BsYXlOYW1lOiBmdW5jdGlvbiBfZ2V0SXRlbURpc3BsYXlOYW1lKGl0ZW0pIHtcbiAgICByZXR1cm4gUmVhY3QuY3JlYXRlRWxlbWVudChcbiAgICAgIFwic3BhblwiLFxuICAgICAgbnVsbCxcbiAgICAgIGl0ZW0ubmFtZVxuICAgICk7XG4gIH0gfSk7XG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogL1VzZXJzL3JhbS9kZXYvanMvd2FpZ28tZnJhbWV3b3JrL3dhaWdvL34vYmFiZWwtbG9hZGVyP2V4cGVyaW1lbnRhbCZvcHRpb25hbD1ydW50aW1lIS4vcGFnZXMvbW9kZWxzL2luZGV4LmpzXG4gKiovIiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBSZWFjdCA9IHJlcXVpcmUoXCJyZWFjdFwiKTtcbnZhciBSb3V0ZXIgPSByZXF1aXJlKFwicmVhY3Qtcm91dGVyXCIpO1xudmFyIExpbmsgPSBSb3V0ZXIuTGluaztcblxudmFyIFRpbWVyID0gcmVxdWlyZShcImNsb2NrbWFrZXJcIikuVGltZXI7XG5cbnZhciBfID0gcmVxdWlyZShcIi4uLy4uL3V0aWxzL2xvZGFzaFwiKSxcbiAgICBMb2FkZXIgPSByZXF1aXJlKFwiLi4vLi4vY29tcG9uZW50cy9sb2FkZXJcIiksXG4gICAgUmVuZGVyVXRpbHMgPSByZXF1aXJlKFwiLi4vLi4vdXRpbHMvcmVuZGVyVXRpbHNcIiksXG4gICAgTW9kZWxUYWJsZSA9IHJlcXVpcmUoXCIuLi8uLi9jb21wb25lbnRzL21vZGVsVGFibGVcIiksXG4gICAgQnV0dG9uID0gcmVxdWlyZShcIi4uLy4uL2NvbXBvbmVudHMvYnV0dG9uXCIpLFxuICAgIEd1YXJkZWRTdGF0ZU1peGluID0gcmVxdWlyZShcIi4uLy4uL21peGlucy9ndWFyZGVkU3RhdGVcIik7XG5cbm1vZHVsZS5leHBvcnRzID0gUmVhY3QuY3JlYXRlQ2xhc3Moe1xuICBkaXNwbGF5TmFtZTogXCJleHBvcnRzXCIsXG5cbiAgY29udGV4dFR5cGVzOiB7XG4gICAgcm91dGVyOiBSZWFjdC5Qcm9wVHlwZXMuZnVuY1xuICB9LFxuXG4gIG1peGluczogW0d1YXJkZWRTdGF0ZU1peGluXSxcblxuICBnZXRJbml0aWFsU3RhdGU6IGZ1bmN0aW9uIGdldEluaXRpYWxTdGF0ZSgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbW9kZWxOYW1lOiBkZWNvZGVVUklDb21wb25lbnQodGhpcy5jb250ZXh0LnJvdXRlci5nZXRDdXJyZW50UGFyYW1zKCkua2V5KSxcbiAgICAgIGNvbHVtbnM6IG51bGwgfTtcbiAgfSxcblxuICBfb25Sb3dDbGljazogZnVuY3Rpb24gX29uUm93Q2xpY2soaXRlbSkge1xuICAgIHRoaXMuY29udGV4dC5yb3V0ZXIudHJhbnNpdGlvblRvKFwibW9kZWxSb3dcIiwge1xuICAgICAga2V5OiB0aGlzLmNvbnRleHQucm91dGVyLmdldEN1cnJlbnRQYXJhbXMoKS5rZXksXG4gICAgICBpZDogaXRlbS5faWRcbiAgICB9KTtcbiAgfSxcblxuICBfb25BZGRDbGljazogZnVuY3Rpb24gX29uQWRkQ2xpY2soKSB7XG4gICAgdGhpcy5jb250ZXh0LnJvdXRlci50cmFuc2l0aW9uVG8oXCJtb2RlbFJvd1wiLCB7XG4gICAgICBrZXk6IHRoaXMuY29udGV4dC5yb3V0ZXIuZ2V0Q3VycmVudFBhcmFtcygpLmtleSxcbiAgICAgIGlkOiBcIm5ld1wiXG4gICAgfSk7XG4gIH0sXG5cbiAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIoKSB7XG4gICAgdmFyIHJlc3VsdCA9IG51bGw7XG5cbiAgICBpZiAoIXRoaXMuc3RhdGUuY29sdW1ucykge1xuICAgICAgcmVzdWx0ID0gUmVhY3QuY3JlYXRlRWxlbWVudChcbiAgICAgICAgXCJkaXZcIixcbiAgICAgICAgbnVsbCxcbiAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChMb2FkZXIsIHsgdGV4dDogXCJMb2FkaW5nIHN0cnVjdHVyZVwiIH0pLFxuICAgICAgICBSZW5kZXJVdGlscy5idWlsZEVycm9yKHRoaXMuc3RhdGUuZXJyb3IpXG4gICAgICApO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXN1bHQgPSBSZWFjdC5jcmVhdGVFbGVtZW50KE1vZGVsVGFibGUsIHtcbiAgICAgICAgbW9kZWxOYW1lOiB0aGlzLnN0YXRlLm1vZGVsTmFtZSxcbiAgICAgICAgY29sdW1uczogdGhpcy5zdGF0ZS5jb2x1bW5zLFxuICAgICAgICBvblJvd0NsaWNrOiB0aGlzLl9vblJvd0NsaWNrIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBSZWFjdC5jcmVhdGVFbGVtZW50KFxuICAgICAgXCJkaXZcIixcbiAgICAgIHsgY2xhc3NOYW1lOiBcInBhZ2UtbW9kZWxcIiB9LFxuICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChCdXR0b24sIHsgaWNvbjogXCJwbHVzLWNpcmNsZVwiLCBsYWJlbDogXCJBZGRcIiwgY2xhc3NOYW1lOiBcImFkZC1idXR0b25cIiwgb25DbGljazogdGhpcy5fb25BZGRDbGljayB9KSxcbiAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgIFwiaDJcIixcbiAgICAgICAgbnVsbCxcbiAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICBMaW5rLFxuICAgICAgICAgIHsgdG86IFwibW9kZWxzXCIgfSxcbiAgICAgICAgICBcIkNvbGxlY3Rpb25cIlxuICAgICAgICApLFxuICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgIFwic3BhblwiLFxuICAgICAgICAgIG51bGwsXG4gICAgICAgICAgXCIgLyBcIixcbiAgICAgICAgICB0aGlzLnN0YXRlLm1vZGVsTmFtZVxuICAgICAgICApXG4gICAgICApLFxuICAgICAgcmVzdWx0XG4gICAgKTtcbiAgfSxcblxuICBjb21wb25lbnREaWRNb3VudDogZnVuY3Rpb24gY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgLy8gZmV0Y2ggY29sdW1uIGluZm9cbiAgICAkLmFqYXgoe1xuICAgICAgdXJsOiBcIi9hZG1pbi9tb2RlbHMvbW9kZWwvY29sdW1uc1wiLFxuICAgICAgZGF0YToge1xuICAgICAgICBmb3JtYXQ6IFwianNvblwiLFxuICAgICAgICBuYW1lOiB0aGlzLnN0YXRlLm1vZGVsTmFtZSB9XG4gICAgfSkuZG9uZShmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgc2VsZi5zZXRTdGF0ZUlmTW91bnRlZCh7XG4gICAgICAgIGNvbHVtbnM6IGRhdGEuY29sdW1uc1xuICAgICAgfSk7XG4gICAgfSkuZmFpbChmdW5jdGlvbiAoeGhyKSB7XG4gICAgICBzZWxmLnNldFN0YXRlSWZNb3VudGVkKHtcbiAgICAgICAgZXJyb3I6IHhoclxuICAgICAgfSk7XG4gICAgfSk7XG4gICAgO1xuICB9IH0pO1xuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC9Vc2Vycy9yYW0vZGV2L2pzL3dhaWdvLWZyYW1ld29yay93YWlnby9+L2JhYmVsLWxvYWRlcj9leHBlcmltZW50YWwmb3B0aW9uYWw9cnVudGltZSEuL3BhZ2VzL21vZGVscy9tb2RlbC5qc1xuICoqLyIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2NvcmUgPSByZXF1aXJlKFwiYmFiZWwtcnVudGltZS9jb3JlLWpzXCIpW1wiZGVmYXVsdFwiXTtcblxudmFyIFJlYWN0ID0gcmVxdWlyZShcInJlYWN0XCIpO1xudmFyIFJvdXRlciA9IHJlcXVpcmUoXCJyZWFjdC1yb3V0ZXJcIik7XG52YXIgTGluayA9IFJvdXRlci5MaW5rO1xuXG52YXIgTG9hZGVyID0gcmVxdWlyZShcIi4uLy4uL2NvbXBvbmVudHMvbG9hZGVyXCIpLFxuICAgIEJ1dHRvbiA9IHJlcXVpcmUoXCIuLi8uLi9jb21wb25lbnRzL2J1dHRvblwiKSxcbiAgICBKc29uRWRpdG9yID0gcmVxdWlyZShcIi4uLy4uL2NvbXBvbmVudHMvanNvbkVkaXRvclwiKSxcbiAgICBNb2RhbCA9IHJlcXVpcmUoXCIuLi8uLi9jb21wb25lbnRzL21vZGFsXCIpLFxuICAgIFJlbmRlclV0aWxzID0gcmVxdWlyZShcIi4uLy4uL3V0aWxzL3JlbmRlclV0aWxzXCIpLFxuICAgIEd1YXJkZWRTdGF0ZU1peGluID0gcmVxdWlyZShcIi4uLy4uL21peGlucy9ndWFyZGVkU3RhdGVcIik7XG5cbm1vZHVsZS5leHBvcnRzID0gUmVhY3QuY3JlYXRlQ2xhc3Moe1xuICBkaXNwbGF5TmFtZTogXCJleHBvcnRzXCIsXG5cbiAgY29udGV4dFR5cGVzOiB7XG4gICAgcm91dGVyOiBSZWFjdC5Qcm9wVHlwZXMuZnVuY1xuICB9LFxuXG4gIG1peGluczogW0d1YXJkZWRTdGF0ZU1peGluXSxcblxuICBnZXRJbml0aWFsU3RhdGU6IGZ1bmN0aW9uIGdldEluaXRpYWxTdGF0ZSgpIHtcbiAgICB2YXIgcGFyYW1zID0gdGhpcy5jb250ZXh0LnJvdXRlci5nZXRDdXJyZW50UGFyYW1zKCk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgbW9kZWxOYW1lOiBkZWNvZGVVUklDb21wb25lbnQocGFyYW1zLmtleSksXG4gICAgICBpZDogZGVjb2RlVVJJQ29tcG9uZW50KHBhcmFtcy5pZCksXG4gICAgICBlcnJvcjogbnVsbCB9O1xuICB9LFxuXG4gIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKCkge1xuICAgIHZhciBlZGl0aW5nRm9ybSA9IHRoaXMuX2J1aWxkRWRpdGluZ0Zvcm0oKTtcblxuICAgIHJldHVybiBSZWFjdC5jcmVhdGVFbGVtZW50KFxuICAgICAgXCJkaXZcIixcbiAgICAgIHsgY2xhc3NOYW1lOiBcInBhZ2UtbW9kZWxSb3dcIiB9LFxuICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChcbiAgICAgICAgXCJoMlwiLFxuICAgICAgICB7IGNsYXNzTmFtZTogXCJ0aXRsZVwiIH0sXG4gICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgTGluayxcbiAgICAgICAgICB7IHRvOiBcIm1vZGVsXCIsIHBhcmFtczogeyBrZXk6IHRoaXMuc3RhdGUubW9kZWxOYW1lIH0gfSxcbiAgICAgICAgICB0aGlzLnN0YXRlLm1vZGVsTmFtZVxuICAgICAgICApLFxuICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgIFwic3BhblwiLFxuICAgICAgICAgIG51bGwsXG4gICAgICAgICAgXCIgLyBcIixcbiAgICAgICAgICB0aGlzLnN0YXRlLmlkXG4gICAgICAgIClcbiAgICAgICksXG4gICAgICBSZW5kZXJVdGlscy5idWlsZEVycm9yKHRoaXMuc3RhdGUuZXJyb3IpLFxuICAgICAgZWRpdGluZ0Zvcm1cbiAgICApO1xuICB9LFxuXG4gIGNvbXBvbmVudERpZE1vdW50OiBmdW5jdGlvbiBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICB0aGlzLl9sb2FkKCk7XG4gIH0sXG5cbiAgX2J1aWxkRWRpdGluZ0Zvcm06IGZ1bmN0aW9uIF9idWlsZEVkaXRpbmdGb3JtKCkge1xuICAgIGlmICh1bmRlZmluZWQgPT09IHRoaXMuc3RhdGUuanNvblN0cikge1xuICAgICAgcmV0dXJuIFJlYWN0LmNyZWF0ZUVsZW1lbnQoTG9hZGVyLCB7IHRleHQ6IFwiTG9hZGluZyBkYXRhXCIgfSk7XG4gICAgfVxuXG4gICAgdmFyIGpzb24gPSB0aGlzLnN0YXRlLmpzb25TdHIgPyBKU09OLnBhcnNlKHRoaXMuc3RhdGUuanNvblN0cikgOiBudWxsO1xuXG4gICAgdmFyIGRlbGV0ZUJ1dHRvbiA9IG51bGwsXG4gICAgICAgIHNhdmVCdG5MYWJlbCA9IFwiQ3JlYXRlXCI7XG5cbiAgICBpZiAoXCJuZXdcIiAhPT0gdGhpcy5zdGF0ZS5pZCkge1xuICAgICAgc2F2ZUJ0bkxhYmVsID0gXCJVcGRhdGVcIjtcblxuICAgICAgZGVsZXRlQnV0dG9uID0gUmVhY3QuY3JlYXRlRWxlbWVudChCdXR0b24sIHsgbGFiZWw6IFwiRGVsZXRlXCIsIGNvbG9yOiBcInJlZFwiLCBvbkNsaWNrOiB0aGlzLl9zaG93RGVsZXRlTW9kYWwgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICBcImRpdlwiLFxuICAgICAgbnVsbCxcbiAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoSnNvbkVkaXRvciwge1xuICAgICAgICBvbkNoYW5nZTogdGhpcy5fb25EYXRhQ2hhbmdlLFxuICAgICAgICB2YWx1ZToganNvbixcbiAgICAgICAgaGVpZ2h0OiBcIjQwMHB4XCIsXG4gICAgICAgIHJlZjogXCJlZGl0b3JcIiB9KSxcbiAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgIFwiZGl2XCIsXG4gICAgICAgIHsgY2xhc3NOYW1lOiBcImFjdGlvbnNcIiB9LFxuICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KEJ1dHRvbiwgeyBsYWJlbDogc2F2ZUJ0bkxhYmVsLCBkaXNhYmxlZDogIWpzb24sIG9uQ2xpY2s6IHRoaXMuX3NhdmUgfSksXG4gICAgICAgIGRlbGV0ZUJ1dHRvblxuICAgICAgKSxcbiAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgIE1vZGFsLFxuICAgICAgICB7XG4gICAgICAgICAgcmVmOiBcImRlbGV0ZU1vZGFsXCIsXG4gICAgICAgICAgaWQ6IFwiZGVsZXRlRG9jTW9kYWxcIixcbiAgICAgICAgICBhY3Rpb25zOiBbXCJZZXNcIiwgXCJOb1wiXSxcbiAgICAgICAgICBvbkFjdGlvbjogdGhpcy5fb25EZWxldGVNb2RhbEFjdGlvbiB9LFxuICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgIFwic3BhblwiLFxuICAgICAgICAgIG51bGwsXG4gICAgICAgICAgXCJBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gcmVtb3ZlIHRoaXMgZG9jdW1lbnQgZnJvbSB0aGUgY29sbGVjdGlvbj9cIlxuICAgICAgICApXG4gICAgICApXG4gICAgKTtcbiAgfSxcblxuICBfb25EYXRhQ2hhbmdlOiBmdW5jdGlvbiBfb25EYXRhQ2hhbmdlKGpzb25TdHIpIHtcbiAgICB0cnkge1xuICAgICAgdmFyIGpzb24gPSBKU09OLnBhcnNlKGpzb25TdHIpO1xuXG4gICAgICAvLyBtdXN0IG5vdCBiZSBlbXB0eSBvYmplY3RcbiAgICAgIGlmICghanNvbiB8fCAhX2NvcmUuT2JqZWN0LmtleXMoanNvbikubGVuZ3RoKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcigpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAganNvblN0cjoganNvblN0clxuICAgICAgfSk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAganNvblN0cjogbnVsbFxuICAgICAgfSk7XG4gICAgfVxuICB9LFxuXG4gIF9sb2FkOiBmdW5jdGlvbiBfbG9hZCgpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICAvLyBpZiBjcmVhdGluZyBhIG5ldyBpdGVtIHRoZW4gbm8gbmVlZCB0byBmZXRjaCBkYXRhIHRvIHN0YXJ0IHdpdGhcbiAgICBpZiAoXCJuZXdcIiA9PT0gdGhpcy5zdGF0ZS5pZCkge1xuICAgICAgcmV0dXJuIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICBqc29uU3RyOiB7fVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgJC5hamF4KHtcbiAgICAgIHVybDogXCIvYWRtaW4vbW9kZWxzL21vZGVsL2RvY1wiLFxuICAgICAgZGF0YToge1xuICAgICAgICBmb3JtYXQ6IFwianNvblwiLFxuICAgICAgICBuYW1lOiB0aGlzLnN0YXRlLm1vZGVsTmFtZSxcbiAgICAgICAgaWQ6IHRoaXMuc3RhdGUuaWQgfVxuICAgIH0pLmRvbmUoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgIHZhciBkb2MgPSBKU09OLnBhcnNlKGRhdGEuZG9jKTtcblxuICAgICAgLy8gcmVtb3ZlIGlkIGF0dHJpYnV0ZVxuICAgICAgZGVsZXRlIGRvYy5faWQ7XG5cbiAgICAgIHNlbGYuc2V0U3RhdGVJZk1vdW50ZWQoe1xuICAgICAgICBqc29uU3RyOiBKU09OLnN0cmluZ2lmeShkb2MpXG4gICAgICB9KTtcbiAgICB9KS5mYWlsKGZ1bmN0aW9uICh4aHIpIHtcbiAgICAgIHNlbGYuc2V0U3RhdGVJZk1vdW50ZWQoe1xuICAgICAgICBlcnJvcjogeGhyXG4gICAgICB9KTtcbiAgICB9KTtcbiAgICA7XG4gIH0sXG5cbiAgX3VwZGF0ZTogZnVuY3Rpb24gX3VwZGF0ZSgpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgIHN1Ym1pdHRpbmc6IHRydWUsXG4gICAgICBlcnJvcjogbnVsbFxuICAgIH0pO1xuXG4gICAgJC5hamF4KHtcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcbiAgICAgIHVybDogXCIvYWRtaW4vbW9kZWxzL21vZGVsL2RvYz9mb3JtYXQ9anNvbiZuYW1lPVwiICsgdGhpcy5zdGF0ZS5tb2RlbE5hbWUgKyBcIiZpZD1cIiArIHRoaXMuc3RhdGUuaWQsXG4gICAgICBkYXRhOiB7XG4gICAgICAgIGRvYzogdGhpcy5zdGF0ZS5qc29uU3RyXG4gICAgICB9XG4gICAgfSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICBNYXRlcmlhbGl6ZS50b2FzdChcIlVwZGF0ZSBzdWNjZXNzZnVsXCIsIDIwMDAsIFwicm91bmRlZFwiKTtcbiAgICB9KS5mYWlsKGZ1bmN0aW9uICh4aHIpIHtcbiAgICAgIHNlbGYuc2V0U3RhdGVJZk1vdW50ZWQoe1xuICAgICAgICBlcnJvcjogeGhyXG4gICAgICB9KTtcbiAgICB9KS5hbHdheXMoZnVuY3Rpb24gKCkge1xuICAgICAgc2VsZi5zZXRTdGF0ZUlmTW91bnRlZCh7XG4gICAgICAgIHN1Ym1pdHRpbmc6IGZhbHNlXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSxcblxuICBfY3JlYXRlOiBmdW5jdGlvbiBfY3JlYXRlKCkge1xuICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgc3VibWl0dGluZzogdHJ1ZSxcbiAgICAgIGVycm9yOiBudWxsXG4gICAgfSk7XG5cbiAgICAkLmFqYXgoe1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIHVybDogXCIvYWRtaW4vbW9kZWxzL21vZGVsL2RvYz9mb3JtYXQ9anNvbiZuYW1lPVwiICsgdGhpcy5zdGF0ZS5tb2RlbE5hbWUsXG4gICAgICBkYXRhOiB7XG4gICAgICAgIGRvYzogdGhpcy5zdGF0ZS5qc29uU3RyXG4gICAgICB9XG4gICAgfSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgTWF0ZXJpYWxpemUudG9hc3QoXCJDcmVhdGUgc3VjY2Vzc2Z1bFwiLCAyMDAwLCBcInJvdW5kZWRcIik7XG5cbiAgICAgIHZhciBkb2MgPSBKU09OLnBhcnNlKGRhdGEuZG9jKSxcbiAgICAgICAgICBpZCA9IGRvYy5faWQ7XG5cbiAgICAgIGRlbGV0ZSBkb2MuX2lkO1xuXG4gICAgICBzZWxmLnNldFN0YXRlSWZNb3VudGVkKHtcbiAgICAgICAgaWQ6IGlkLFxuICAgICAgICBqc29uU3RyOiBKU09OLnN0cmluZ2lmeShkb2MpIH0pO1xuICAgIH0pLmZhaWwoZnVuY3Rpb24gKHhocikge1xuICAgICAgc2VsZi5zZXRTdGF0ZUlmTW91bnRlZCh7XG4gICAgICAgIGVycm9yOiB4aHJcbiAgICAgIH0pO1xuICAgIH0pLmFsd2F5cyhmdW5jdGlvbiAoKSB7XG4gICAgICBzZWxmLnNldFN0YXRlSWZNb3VudGVkKHtcbiAgICAgICAgc3VibWl0dGluZzogZmFsc2VcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9LFxuXG4gIF9zYXZlOiBmdW5jdGlvbiBfc2F2ZSgpIHtcbiAgICBpZiAoXCJuZXdcIiA9PT0gdGhpcy5zdGF0ZS5pZCkge1xuICAgICAgdGhpcy5fY3JlYXRlKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3VwZGF0ZSgpO1xuICAgIH1cbiAgfSxcblxuICBfZGVsZXRlOiBmdW5jdGlvbiBfZGVsZXRlKCkge1xuICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgc3VibWl0dGluZzogdHJ1ZSxcbiAgICAgIGVycm9yOiBudWxsIH0pO1xuXG4gICAgJC5hamF4KHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIHVybDogXCIvYWRtaW4vbW9kZWxzL21vZGVsL2RvYz9mb3JtYXQ9anNvbiZuYW1lPVwiICsgdGhpcy5zdGF0ZS5tb2RlbE5hbWUgKyBcIiZpZD1cIiArIHRoaXMuc3RhdGUuaWQgfSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICBNYXRlcmlhbGl6ZS50b2FzdChcIkRlbGV0ZSBzdWNjZXNzZnVsXCIsIDIwMDAsIFwicm91bmRlZFwiKTtcblxuICAgICAgc2VsZi5jb250ZXh0LnJvdXRlci50cmFuc2l0aW9uVG8oXCJtb2RlbFwiLCB7XG4gICAgICAgIGtleTogc2VsZi5jb250ZXh0LnJvdXRlci5nZXRDdXJyZW50UGFyYW1zKCkua2V5IH0pO1xuICAgIH0pLmZhaWwoZnVuY3Rpb24gKHhocikge1xuICAgICAgc2VsZi5zZXRTdGF0ZUlmTW91bnRlZCh7XG4gICAgICAgIGVycm9yOiB4aHJcbiAgICAgIH0pO1xuICAgIH0pLmFsd2F5cyhmdW5jdGlvbiAoKSB7XG4gICAgICBzZWxmLnNldFN0YXRlSWZNb3VudGVkKHtcbiAgICAgICAgc3VibWl0dGluZzogZmFsc2VcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9LFxuXG4gIF9zaG93RGVsZXRlTW9kYWw6IGZ1bmN0aW9uIF9zaG93RGVsZXRlTW9kYWwoKSB7XG4gICAgdGhpcy5yZWZzLmRlbGV0ZU1vZGFsLm9wZW4oKTtcbiAgfSxcblxuICBfb25EZWxldGVNb2RhbEFjdGlvbjogZnVuY3Rpb24gX29uRGVsZXRlTW9kYWxBY3Rpb24oYWN0aW9uKSB7XG4gICAgaWYgKFwieWVzXCIgPT09IGFjdGlvbi50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICB0aGlzLl9kZWxldGUoKTtcbiAgICB9XG4gIH0gfSk7XG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogL1VzZXJzL3JhbS9kZXYvanMvd2FpZ28tZnJhbWV3b3JrL3dhaWdvL34vYmFiZWwtbG9hZGVyP2V4cGVyaW1lbnRhbCZvcHRpb25hbD1ydW50aW1lIS4vcGFnZXMvbW9kZWxzL3Jvdy5qc1xuICoqLyJdLCJzb3VyY2VSb290IjoiIn0=