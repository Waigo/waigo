webpackJsonp([2],{0:function(e,t,n){"use strict";var a=n(20),o=n(21),r=o.DefaultRoute,s=o.RouteHandler,i=o.Route,l=n(29),d=n(30),m=n(31),u=a.createClass({displayName:"App",render:function(){return a.createElement(s,this.props)}}),c=a.createElement(i,{handler:u},a.createElement(r,{name:"models",handler:l}),a.createElement(i,{name:"model",path:"/:key",handler:d}),a.createElement(i,{name:"modelRow",path:"/:key/:id",handler:m}));o.run(c,o.HashLocation,function(e,t){a.render(a.createElement(e,{routes:t.routes,params:t.params,query:t.query}),document.getElementById("react-root"))})},29:function(e,t,n){"use strict";{var a=n(20),o=n(21),r=(o.Link,n(6));n(18)}e.exports=a.createClass({displayName:"exports",render:function(){return a.createElement("div",{className:"page-models"},a.createElement(r,{ajaxUrl:"/admin/models?format=json",ajaxResponseDataMapper:this._mapAjaxData,itemDisplayNameFormatter:this._getItemDisplayName,itemRoute:"model"}))},_mapAjaxData:function(e){return e=e||{},(e.models||[]).map(function(e){return{key:e,name:e}})},_getItemDisplayName:function(e){return a.createElement("span",null,e.name)}})},30:function(e,t,n){"use strict";var a=n(20),o=n(21),r=o.Link,s=(n(19).Timer,n(17),n(9)),i=n(18),l=n(11),d=n(3),m=n(16);e.exports=a.createClass({displayName:"exports",contextTypes:{router:a.PropTypes.func},mixins:[m],getInitialState:function(){return{modelName:decodeURIComponent(this.context.router.getCurrentParams().key),columns:null}},_onRowClick:function(e){this.context.router.transitionTo("modelRow",{key:this.context.router.getCurrentParams().key,id:e._id})},_onAddClick:function(){this.context.router.transitionTo("modelRow",{key:this.context.router.getCurrentParams().key,id:"new"})},render:function(){var e=null;return e=this.state.columns?a.createElement(l,{modelName:this.state.modelName,columns:this.state.columns,onRowClick:this._onRowClick}):a.createElement("div",null,a.createElement(s,{text:"Loading structure"}),i.buildError(this.state.error)),a.createElement("div",{className:"page-model"},a.createElement(d,{icon:"plus-circle",label:"Add",className:"add-button",onClick:this._onAddClick}),a.createElement("h2",null,a.createElement(r,{to:"models"},"Collection"),a.createElement("span",null," / ",this.state.modelName)),e)},componentDidMount:function(){var e=this;$.ajax({url:"/admin/models/model/columns",data:{format:"json",name:this.state.modelName}}).done(function(t){e.setStateIfMounted({columns:t.columns})}).fail(function(t){e.setStateIfMounted({error:t})})}})},31:function(e,t,n){"use strict";var a=n(62)["default"],o=n(20),r=n(21),s=r.Link,i=n(9),l=n(3),d=n(7),m=n(10),u=n(18),c=n(16);e.exports=o.createClass({displayName:"exports",contextTypes:{router:o.PropTypes.func},mixins:[c],getInitialState:function(){var e=this.context.router.getCurrentParams();return{modelName:decodeURIComponent(e.key),id:decodeURIComponent(e.id),error:null}},render:function(){var e=this._buildEditingForm();return o.createElement("div",{className:"page-modelRow"},o.createElement("h2",{className:"title"},o.createElement(s,{to:"model",params:{key:this.state.modelName}},this.state.modelName),o.createElement("span",null," / ",this.state.id)),u.buildError(this.state.error),e)},componentDidMount:function(){this._load()},_buildEditingForm:function(){if(void 0===this.state.jsonStr)return o.createElement(i,{text:"Loading data"});var e=this.state.jsonStr?JSON.parse(this.state.jsonStr):null,t=null,n="Create";return"new"!==this.state.id&&(n="Update",t=o.createElement(l,{label:"Delete",color:"red",onClick:this._showDeleteModal})),o.createElement("div",null,o.createElement(d,{onChange:this._onDataChange,value:e,height:"400px",ref:"editor"}),o.createElement("div",{className:"actions"},o.createElement(l,{label:n,disabled:!e,onClick:this._save}),t),o.createElement(m,{ref:"deleteModal",id:"deleteDocModal",actions:["Yes","No"],onAction:this._onDeleteModalAction},o.createElement("span",null,"Are you sure you want to remove this document from the collection?")))},_onDataChange:function(e){try{var t=JSON.parse(e);if(!t||!a.Object.keys(t).length)throw new Error;this.setState({jsonStr:e})}catch(n){this.setState({jsonStr:null})}},_load:function(){var e=this;return"new"===this.state.id?this.setState({jsonStr:{}}):void $.ajax({url:"/admin/models/model/doc",data:{format:"json",name:this.state.modelName,id:this.state.id}}).done(function(t){var n=JSON.parse(t.doc);delete n._id,e.setStateIfMounted({jsonStr:JSON.stringify(n)})}).fail(function(t){e.setStateIfMounted({error:t})})},_update:function(){var e=this;this.setState({submitting:!0,error:null}),$.ajax({method:"PUT",url:"/admin/models/model/doc?format=json&name="+this.state.modelName+"&id="+this.state.id,data:{doc:this.state.jsonStr}}).then(function(){Materialize.toast("Update successful",2e3,"rounded")}).fail(function(t){e.setStateIfMounted({error:t})}).always(function(){e.setStateIfMounted({submitting:!1})})},_create:function(){var e=this;this.setState({submitting:!0,error:null}),$.ajax({method:"POST",url:"/admin/models/model/doc?format=json&name="+this.state.modelName,data:{doc:this.state.jsonStr}}).then(function(t){Materialize.toast("Create successful",2e3,"rounded");var n=JSON.parse(t.doc),a=n._id;delete n._id,e.setStateIfMounted({id:a,jsonStr:JSON.stringify(n)})}).fail(function(t){e.setStateIfMounted({error:t})}).always(function(){e.setStateIfMounted({submitting:!1})})},_save:function(){"new"===this.state.id?this._create():this._update()},_delete:function(){var e=this;this.setState({submitting:!0,error:null}),$.ajax({method:"DELETE",url:"/admin/models/model/doc?format=json&name="+this.state.modelName+"&id="+this.state.id}).then(function(){Materialize.toast("Delete successful",2e3,"rounded"),e.context.router.transitionTo("model",{key:e.context.router.getCurrentParams().key})}).fail(function(t){e.setStateIfMounted({error:t})}).always(function(){e.setStateIfMounted({submitting:!1})})},_showDeleteModal:function(){this.refs.deleteModal.open()},_onDeleteModalAction:function(e){"yes"===e.toLowerCase()&&this._delete()}})}});