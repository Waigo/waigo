webpackJsonp([1],{0:function(e,t,n){"use strict";var a=n(9),r=n(10),o=r.DefaultRoute,i=r.RouteHandler,s=r.Route,l=n(12),u=n(13),m=n(14),d=a.createClass({displayName:"App",render:function(){return a.createElement(i,this.props)}}),c=a.createElement(s,{handler:d},a.createElement(o,{name:"models",handler:l}),a.createElement(s,{name:"model",path:"/:key",handler:u}),a.createElement(s,{name:"modelRow",path:"/:key/:id",handler:m}));r.run(c,r.HashLocation,function(e,t){a.render(a.createElement(e,{routes:t.routes,params:t.params,query:t.query}),document.getElementById("react-root"))})},12:function(e,t,n){"use strict";{var a=n(9),r=n(10),o=(r.Link,n(2));n(8)}e.exports=a.createClass({displayName:"exports",render:function(){return a.createElement("div",{className:"page-models"},a.createElement(o,{ajaxUrl:"/admin/models?format=json",ajaxResponseDataMapper:this._mapAjaxData,itemDisplayNameFormatter:this._getItemDisplayName,itemRoute:"model"}))},_mapAjaxData:function(e){return e=e||{},(e.models||[]).map(function(e){return{key:e,name:e}})},_getItemDisplayName:function(e){return a.createElement("span",null,e.name)}})},13:function(e,t,n){"use strict";var a=n(9),r=n(10),o=(r.Link,n(7)),i=n(4),s=n(8),l=n(6);e.exports=a.createClass({displayName:"exports",contextTypes:{router:a.PropTypes.func},mixins:[l],getInitialState:function(){return{modelName:decodeURIComponent(this.context.router.getCurrentParams().key),loading:!0,error:null}},render:function(){var e=null;return e=this.state.columns?this._buildTable():a.createElement(i,{text:"Loading structure"}),a.createElement("div",{className:"page-model"},a.createElement("h2",null,"Collection: ",this.state.modelName),s.buildError(this.state.error),e)},_onRowClick:function(e){e.preventDefault(),this.context.router.transitionTo("modelRow",{key:this.context.router.getCurrentParams().key,id:e.currentTarget.id})},_buildTable:function(){var e=this,t=this.state.columns,n=this.state.rows||[],r=t.map(function(e){return a.createElement("th",null,e.name)}),s=null;return s=this.state.loading?a.createElement("tr",null,a.createElement("td",null,a.createElement(i,null))):n.map(function(n){var r=t.map(function(e){var t=n[e.name],r=null;return"Date"===e.type?(r=t,t=new Date(t).toString()):Array.isArray(t)?(e.subKey&&(t=o.pluck(t,subKey)),t=t.map(function(e){return a.createElement("li",{key:e},e)}),t=a.createElement("ul",null,t)):"object"==typeof t&&(t=JSON.stringify(t)),a.createElement("td",{key:e.name,dataFlipValue:r},t)});return a.createElement("tr",{id:n._id,key:n._id,onClick:e._onRowClick},r)}),a.createElement("table",{className:"hoverable bordered"},a.createElement("thead",null,a.createElement("tr",null,r)),a.createElement("tbody",null,s))},_fetchRows:function(){var e=this;this.setState({loading:!0});var t=o.pluck(this.state.columns,"name");$.ajax({url:"/admin/models/model/rows",data:{format:"json",name:this.state.modelName,columns:t}}).done(function(t){e.setStateIfMounted({rows:t.rows})}).fail(function(t){e.setStateIfMounted({error:t})}).always(function(){e.setStateIfMounted({loading:!1})})},componentDidMount:function(){var e=this;$.ajax({url:"/admin/models/model/columns",data:{format:"json",name:this.state.modelName}}).done(function(t){e.setStateIfMounted({columns:t.columns}),e._fetchRows()}).fail(function(t){e.setStateIfMounted({error:t})})}})},14:function(e,t,n){"use strict";var a=n(72)["default"],r=n(9),o=n(10),i=(o.Link,n(4)),s=n(5),l=n(3),u=n(8),m=n(6);e.exports=r.createClass({displayName:"exports",contextTypes:{router:r.PropTypes.func},mixins:[m],getInitialState:function(){var e=this.context.router.getCurrentParams();return{modelName:decodeURIComponent(e.key),id:decodeURIComponent(e.id),error:null}},render:function(){var e=this._buildEditingForm();return r.createElement("div",{className:"page-modelRow"},r.createElement("h2",{className:"title"},this.state.modelName,"/",this.state.id),u.buildError(this.state.error),e)},_onEdit:function(){this.setState({edit:this._getLatestEdit()})},_getLatestEdit:function(){return r.findDOMNode(this.refs.editInput).value},_onSubmit:function(e){e.preventDefault();var t=this;this.setState({submitting:!0}),$.ajax({method:"PUT",url:"/admin/models/model/doc?format=json&name="+this.state.modelName+"&id="+this.state.id,data:{doc:this.state.json}}).then(function(){Materialize.toast("Update successful",2e3,"rounded")}).fail(function(e){t.setStateIfMounted({error:e})}).always(function(){t.setStateIfMounted({submitting:!1})})},_onDataChange:function(e){try{var t=JSON.parse(e);if(!t||!a.Object.keys(t).length)throw new Error;this.setState({json:t})}catch(n){this.setState({json:null})}},_buildEditingForm:function(){var e=this.state.json;return void 0===e?r.createElement(i,{text:"Loading data"}):r.createElement("form",{onSubmit:this._onSubmit},r.createElement(l,{name:"docEditor",onChange:this._onDataChange,value:JSON.stringify(e,null,2),height:"400px"}),r.createElement(s,{label:"Update",disabled:!e}))},componentDidMount:function(){var e=this;$.ajax({url:"/admin/models/model/doc",data:{format:"json",name:this.state.modelName,id:this.state.id}}).done(function(t){var n=t.doc;delete n._id,e.setStateIfMounted({json:n})}).fail(function(t){e.setStateIfMounted({error:t})})}})}});